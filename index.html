<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>XPAIO - Sandbox Reset</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <style>
        body { background-color: #0d1117; color: #fff; font-family: sans-serif; text-align: center; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .container { padding: 30px; border-radius: 15px; background: #161b22; border: 2px solid #58a6ff; width: 90%; max-width: 400px; }
        .code-display { background: #000; color: #39ff14; padding: 20px; font-size: 1.5em; font-family: monospace; border-radius: 10px; margin: 20px 0; word-break: break-all; border: 1px dashed #39ff14; }
    </style>
</head>
<body>
    <div class="container">
        <h2>XPAIO 보안 코드 확인</h2>
        <p style="color: #8b949e;">아래 코드가 샌드박스용 보안 코드입니다.</p>
        
        <div id="code-result" class="code-display">SDK 연결 중...</div>
        
        <p style="font-size: 0.8em; color: #58a6ff;">이 코드를 개발자 포털 Sandbox 칸에 입력하세요.</p>
        <button onclick="location.reload()" style="background:#58a6ff; color:#fff; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;">코드 재발급(새로고침)</button>
    </div>

    <script>
        async function forceGetSandboxCode() {
            const display = document.getElementById("code-result");
            try {
                // 기존 세션을 무시하고 새로 인증을 시도하여 코드를 유도합니다.
                await window.Pi.init({ version: "2.0", sandbox: true });
                const auth = await window.Pi.authenticate(['username'], (pay) => {});
                display.innerText = "이미 인증됨 (정상)";
                display.style.color = "#58a6ff";
            } catch (err) {
                // SDK가 뿜어내는 에러 메시지 전체를 화면에 표시합니다.
                console.log("Captured Error:", err);
                // 안내 문구가 아닌 '진짜 코드'만 뿜어내도록 설정
                display.innerText = err.message || JSON.stringify(err);
            }
        }
        window.onload = forceGetSandboxCode;
    </script>
</body>
</html>